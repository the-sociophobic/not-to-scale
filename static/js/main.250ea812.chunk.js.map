{"version":3,"sources":["img/logo.svg","img/logo-small.svg","utils/store/storeClass.js","utils/store/StoreContext.js","utils/browserType.js","utils/preventMobileScrolling.js","components/Header.js","components/Input.js","utils/secondsParse.js","pages/Spekt.js","components/withRouterAndRef.js","pages/Admin.js","utils/encodeParams.js","components/ExternalLink.js","components/Footer.js","components/Canvas.js","utils/isTouchDevice.js","components/OpenBrowser.js","App.js","utils/store/index.js","serviceWorker.js","index.js"],"names":["module","exports","store","props","getSessionInfo","userId","a","axios","post","DBlink","data","login","credentials","res","audioURL","nextChapter","currentChapter","logout","this","defaults","headers","withCredentials","StoreContext","React","createContext","standalone","window","navigator","userAgent","toLowerCase","safari","test","preventDefault","event","registerListeners","element","zoomOnly","addEventListener","passive","unregisterListeners","removeEventListener","Header","state","render","className","Component","Input","focus","inputFieldRef","current","blur","onKeyDown","e","value","number","match","onChange","replace","onFocus","onBlur","errorMessage","ref","type","password","placeholder","required","target","disabled","label","createRef","makeTwoSymbol","seconds","Math","floor","PLAY","Spekt","componentDidMount","context","setState","authorised","userState","secondUser","ticket","setTimeout","console","log","localStorage","removeItem","location","reload","texts","left","canSelect","chapters","message","secondsParse","time","setItem","initializeAudio","audio","Audio","buttonStatus","duration","comment","slice","forEach","line","index","split","reduce","b","buttonDisabled","length","playInterval","clearInterval","oneSecond","preload","src","load","pressButton","play","restart","pause","currentTime","name","setInterval","nextChapterStart","buyAnotherTicket","open","renderLogin","buttonText","error","onClick","renderSelect","renderSpekt","getItem","exitClicked","contextType","withRouter","WrappedComponent","InnerComponentWithRef","forwardRef","rest","ComponentWithRouter","withRef","Admin","loadData","fetch","json","deleteData","JSON","id","stringify","addData","params","Object","entries","map","key","encodeURIComponent","join","loggedIn","file","undefined","onFileLoaded","fileInfo","used","format","Date","href","to","newTab","rel","children","elemRef","ExternalLink","logoImg","logoSmallImg","resizeObserver","ResizeObserver","resize","observe","canvasRef","ctx","getCtx","canvas","width","clientWidth","height","clientHeight","getContext","setPos","pos","x","clientX","y","clientY","setPosTouch","touch","changedTouches","pageX","pageY","draw","buttons","beginPath","lineWidth","lineCap","strokeStyle","moveTo","lineTo","stroke","drawTouch","pressed","document","createEvent","isTouchDevice","links","firstLink","browserType","secondLink","App","stateRefs","footerRef","componentWillUnmount","Provider","appRef","OpenBrowser","exact","path","storeClass","Boolean","hostname","ReactDOM","StrictMode","getElementById","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.250ea812.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.2e5601ef.svg\";","module.exports = __webpack_public_path__ + \"static/media/logo-small.babf93f8.svg\";","import axios from 'axios'\n\n\nexport default class store {\n  constructor(props) {\n    this.props = props\n\n    axios.defaults.headers.post['Accept'] = \"*/*\"\n    axios.defaults.headers.post['Content-Type'] = \"json\"\n    axios.defaults.withCredentials = true\n\n  }\n\n  getSessionInfo = async userId =>\n    (await axios.post(this.props.DBlink, {userId: userId})).data\n\n  login = async credentials => {   \n    const res = (await axios.post(\n      this.props.DBlink + '/login/',\n      credentials,\n    )).data\n\n    // console.log(res)\n    \n    return res\n  }\n\n  audioURL = userId =>\n    this.props.DBlink + '/stream/' + userId\n\n  nextChapter = (userId, currentChapter) =>\n    axios.post(this.props.DBlink + '/next', {\n      userId: userId,\n      currentChapter: currentChapter,\n    })\n\n  logout = async userId =>\n    await axios\n      .post(\n        this.props.DBlink + '/logout/',\n        { userId: userId }\n      )\n}","import React from 'react'\n\nconst StoreContext = React.createContext(\"new store()\")\nexport default StoreContext","export default () => {\n  const standalone = window.navigator.standalone,\n        userAgent = window.navigator.userAgent.toLowerCase(),\n        safari = /safari/.test( userAgent ),\n        ios = /iphone|ipod|ipad/.test( userAgent )\n\n  if( ios ) {\n    if ( !standalone && safari )\n      return \"browser\"\n    else\n      if ( standalone && !safari )\n        return \"standalone\"\n      else\n        if ( !standalone && !safari )\n          return \"uiwebview\"\n  } else\n    return \"not iOS\"\n}\n\n","const preventDefault = event => event.preventDefault()\n\nconst registerListeners = (element, zoomOnly) => {\n  element.addEventListener( 'wheel', preventDefault, { passive: false } )\n  // element.addEventListener( 'touchstart', preventDefault, { passive: false } )\n  // element.addEventListener( 'touchend', preventDefault, { passive: false } )\n  !zoomOnly && element.addEventListener( 'touchmove', preventDefault, { passive: false } )\n}\n\nconst unregisterListeners = (element, zoomOnly) => {\n  element.removeEventListener( 'wheel', preventDefault, { passive: false } )\n  // element.removeEventListener( 'touchstart', preventDefault, { passive: false } )\n  // element.removeEventListener( 'touchend', preventDefault, { passive: false } )\n  !zoomOnly && element.removeEventListener( 'touchmove', preventDefault, { passive: false } )\n}\n\nexport { registerListeners, unregisterListeners }","import React from 'react'\n\n\n class Header extends React.Component {\n  state = {}\n\n  render = () =>\n    <div className=\"header\">\n      <div className=\"container\">\n        <b>Not to scale</b>\n      </div>\n    </div>\n}\n\nexport default Header","import React, { Component } from 'react'\n\n\nexport default class Input extends Component {\n  constructor(props) {\n    super(props)\n    this.inputFieldRef = props.inputFieldRef || React.createRef()\n  }\n\n  focus = () => this.inputFieldRef.current && this.inputFieldRef.current.focus()\n  blur = () => this.inputFieldRef.current && this.inputFieldRef.current.blur()\n\n  onKeyDown = e => {\n    const value = \"\" + this.props.value\n    \n    if (this.props.number)\n      if (this.props.value && value.match(/[^0-9]/g))\n        this.props.onChange(value.replace(/[^0-9]/g, ''))\n    this.props.onKeyDown && this.props.onKeyDown(e)\n  }\n  onFocus = e => {\n    this.props.onFocus && this.props.onFocus(e)\n  }\n  onBlur = e => {\n    this.props.onBlur && this.props.onBlur(e)\n  }\n\n  render = () => (\n    <div\n      className={\"form-group \" +\n        this.props.className + \" \" +\n        (this.props.errorMessage && \"form-group--error\")\n      }\n    >\n      <input\n        ref={this.inputFieldRef}\n        type={this.props.password ? \"password\" : \"text\"}\n        className={`form-group__input ${this.props.className}`}\n        placeholder={this.props.placeholder}\n        required={this.props.required}\n        value={this.props.value}\n        onChange={event => this.props.onChange(event.target.value)}\n        onFocus={this.onFocus}\n        onBlur={this.onBlur}\n        onKeyDown={this.onKeyDown}\n        disabled={this.props.disabled}\n      />\n      {this.props.label &&\n        <label className=\"form-group__label\">\n          {this.props.label}\n        </label>}\n    </div>\n  )\n}\n","const makeTwoSymbol = number =>\n  number > 9 ? number : `0${number}`\n\nexport default seconds =>\n  `${makeTwoSymbol(Math.floor(seconds / 60))}:${makeTwoSymbol(Math.floor(seconds % 60))}`","import React, { Component } from 'react'\n\nimport Header from 'components/Header'\n\nimport { StoreContext } from 'utils/store'\nimport withRouter from 'components/withRouterAndRef'\nimport Input from 'components/Input'\n\nimport secondsParse from 'utils/secondsParse'\n\n\nconst oneSecond = 1000\n\nconst PLAY = () =>\n  <div className=\"play-symbol\" />\n\n\nclass Spekt extends Component {\n  constructor(props) {\n    super(props)\n\n    // const userId = new URLSearchParams(window.location.search).get(\"q\")\n    const userId = window.localStorage.getItem('userId')\n\n    this.state = {\n      ticket: \"\",\n\n      /*\n        real\n\n        fake\n        outdated\n        many-devices\n\n        none\n        pending\n      */\n      authorised: \"pending\",\n      userId: userId || \"\",\n\n      /*\n        real\n        pending\n      */\n      secondUser: \"pending\",\n\n      /*\n        never-pressed\n        buffering\n        countdown\n        can-play\n        can-restart\n        in-process\n        buy-another-ticket\n      */\n      buttonStatus: \"never-pressed\",\n      currentChapter: 0,\n\n      message: \"00:00\",\n      comment: <>Нажмите <PLAY /> чтобы запустить<br />буферизацию</>,\n\n      exitClicked: 0,\n    }\n  }\n\n  componentDidMount = () =>\n    this.getSessionInfo()\n\n  getSessionInfo = async () => {\n    const res = await this.context.store.getSessionInfo(this.state.userId)\n\n    this.setState({\n      authorised: res.userState,\n      secondUser: res.secondUser,\n      ticket: res.ticket || \"\",\n    })\n\n    if (res.userState === \"real\")\n      setTimeout(() => this.login(), 500)\n  }\n\n  logout = () => {\n    console.log(\"aaa\")\n    window.localStorage.removeItem('userId')\n    this.context.store.logout()\n    window.location.reload(false)\n  }\n\n  login = async () => {\n    this.setState({\n      authorised: \"pending\",\n      secondUser: \"real\"\n    })\n    \n    const res = await this.context.store\n      .login({\n        ticket: this.state.ticket || \"a\",\n        userId: this.state.userId,\n      })\n\n    console.log(res)\n\n    if (res.userState === \"real\") {\n      this.setState({\n        userId: res.userId,\n        authorised: \"real\",\n        ticket: res.ticket,\n        texts: res.texts,\n        left: res.left,\n        canSelect: res.canSelect,\n        chapters: res.chapters,\n        currentChapter: res.currentChapter,\n        message: secondsParse(res.chapters[res.currentChapter].time),\n      })\n\n      // console.log(res)\n      \n      // this.props.history.push({\n      //   pathname: this.props.location.path,\n      //   search: \"?\" + new URLSearchParams({q: res.userId}).toString()\n      // })\n      window.localStorage.setItem('userId', res.userId)\n    }\n    else\n      this.setState({authorised: res.userState})\n  }\n\n\n  initializeAudio = () => {\n    this.audio = new Audio()\n\n    this.audio.addEventListener('canplay', () =>\n      this.state.buttonStatus !== \"can-restart\" &&\n        setTimeout(() => {\n          this.setState({\n            buttonStatus: \"countdown\",\n            message: `${secondsParse(this.state.chapters[this.state.currentChapter].time)}/${secondsParse(this.audio.duration)}`,\n            // comment: <>Нажмите <PLAY /> чтобы <br />начать спектакль</>\n            comment: this.state.texts[0]\n          })\n          \n          this.state.texts.slice(1)\n            .forEach((line, index) =>\n              setTimeout(() => \n                this.setState({\n                  comment: line.split('PLAY')\n                    .reduce((a, b) => <>{a}<PLAY />{b}</>)\n                })\n              , oneSecond * (index + 1)))\n\n          setTimeout(() =>\n            this.setState({\n              buttonStatus: \"can-play\",\n              buttonDisabled: false,\n            })\n          , oneSecond * (this.state.texts.length - 1))\n          // , 100)\n\n        // }, oneSecond * 1)\n        }, 100)\n    )\n\n\n    this.audio.addEventListener('ended', () => {\n      if (this.playInterval)\n        clearInterval(this.playInterval)\n\n      setTimeout(() => {\n        this.setState({\n          buttonStatus: \"buy-another-ticket\",\n          comment: \"Спасибо за просмотр! Хотите посмотреть ещё, купите билет\"\n        })\n\n        this.context.store.logout(this.state.userId)\n        window.localStorage.removeItem('userId')\n      }, oneSecond * 5)\n    })\n\n    this.audio.preload = 'auto'\n    this.audio.src = this.context.store.audioURL(this.state.userId)\n    this.audio.load()\n  }\n\n  pressButton = () => {\n    const { buttonStatus } = this.state\n\n    switch(buttonStatus) {\n      case \"never-pressed\":\n        this.initializeAudio()\n\n        this.setState({\n          buttonStatus: \"buffering\",\n          message: \"Буферизация...\",\n          comment: \"\",\n          buttonDisabled: true,\n        })\n        return\n      case \"can-play\":\n        this.play()\n    }\n  }\n\n  restart = () => {\n    this.audio.pause()\n    this.audio.currentTime = this.state.chapters[this.state.currentChapter].time\n    if (this.playInterval) {\n      clearInterval(this.playInterval)\n      this.playInterval = null\n    }\n    this.play()\n  }\n\n  play = () => {\n    if (this.playInterval)\n      return\n\n    this.audio.currentTime = this.state.chapters[this.state.currentChapter].time\n\n    this.setState({\n      buttonStatus: \"can-restart\",\n      buttonDisabled: true,\n      message: `${secondsParse(this.audio.currentTime)}/${secondsParse(this.audio.duration)}`,\n      // comment: <>Вы можете перезапустить спектакль <br className=\"desktop-only\" />в течении первых 60&nbsp;секунд</>,\n      comment: this.state.chapters[this.state.currentChapter].name,\n    })\n\n    this.playInterval = setInterval(() => {\n      // if (this.audio.currentTime > 60 && this.state.buttonStatus === \"can-restart\")\n      //   this.setState({\n      //     buttonStatus: \"in-process\",\n      //     comment: \"\",\n      //   })\n\n      console.log(this.audio.duration)\n      this.setState({\n        message: `${secondsParse(this.audio.currentTime)}/${secondsParse(this.audio.duration)}`,\n        comment: this.state.chapters[this.state.currentChapter].name\n      })\n\n      const nextChapterStart = this.state.currentChapter < this.state.chapters.length - 1 ?\n        this.state.chapters[this.state.currentChapter + 1].time\n        :\n        this.audio.duration\n      if (this.audio.currentTime > nextChapterStart) {\n        this.context.store.nextChapter(this.state.userId, this.state.currentChapter)\n        if (this.state.currentChapter < this.state.chapters.length - 1)\n          this.setState({currentChapter: this.state.currentChapter + 1})\n      }\n    }, oneSecond)\n\n    this.audio.play()\n  }\n\n  buyAnotherTicket = () => {\n    const win = window.open(\"https://tochkadostupa.spb.ru/events/not_to_scale\", '_blank')\n    win.focus()\n  }\n\n\n  renderLogin = () => {\n    const error = this.state.authorised && this.state.authorised.match(/outdated|many-devices|fake/gm)\n    let buttonText\n    \n    switch(this.state.authorised) {\n      case \"outdated\":\n        buttonText = \"Билет с таким номером уже использован\"\n        break\n      case \"many-devices\":\n        buttonText = \"Билет используется на более чем 3х устройствах\"\n        break\n      case \"fake\":\n        buttonText = \"Билета с таким номером не существует\"\n        break\n      default:\n        buttonText = \"Начать\"\n    }\n\n    return (\n      <div className=\"spekt__login\">\n        <div className=\"spekt__login__desc\">\n          <b>Not to scale</b> — это спектакль Энта Хэмптона и Тима Этчелса. Вам понадобятся наушники, карандаш, ластик, и лист бумаги. И второй человек. Введите номер вашего билета, нажмите кнопку «начать» и следуйте инструкциям.\n        </div>\n        <Input\n          className={error && \"form-group__input--danger\"}\n          placeholder=\"Введите номер вашего билета\"\n          value={this.state.ticket}\n          onChange={value => this.setState({ticket: value, authorised: \"\"})}\n        />\n        <button\n          className={`button button--main ${error && \"button--main--danger\"}`}\n          onClick={() => this.login()}\n          disabled={!this.state.ticket || this.state.ticket.length < 5}\n        >\n          {buttonText}\n        </button>\n      </div>\n    )\n  }\n\n  renderSelect = () =>\n    <div className=\"spekt__select\">\n      <div className=\"spekt__select\">\n        Выберите место за столом\n      </div>\n      <div className=\"spekt__select__picture\">\n        <div className=\"spekt__select__picture__top-list\">\n\n        </div>\n      </div>\n    </div>\n\n  renderSpekt = () =>\n    <div className=\"spekt__spekt\">\n\n      <div className=\"spekt__spekt__instructions\">\n        Для участия в спектакле Вам <b>понадобятся</b>:<br />\n        1. Другой человек — Ваш партнер, находящийся рядом с Вами<br />\n        2. Два устройства для запуска звука (ноутбук, планшет, смартфон)<br />\n        3. Две пары наушников (для Вас и Вашего партнера)<br />\n        4. Плоская поверхность, на которой можно рисовать (стол) — поверхность должна быть большая, чтобы на ней помещались четыре листа формата А4<br />\n        5. Девять листов белой бумаги формата А4<br />\n        6. Два заточенных простых карандаша + один запасной<br />\n        7. Два ластика<br /><br />\n\n\n        Дальше…<br /><br />\n\n        Сядьте {this.state.left ? <b>слева</b> : <b>справа</b>} от другого участника перед поверхностью, на которой будете рисовать. Включите на телефоне режим «не беспокоить». Удостоверьитесь, что режим экономии энергии выключен и экран устройства не погаснет. Наденьте наушники. Положите перед собой по листу бумаги вертикально, в книжной ориентации.\n        Остальные листы бумаги положите в стопку.<br /><br />\n        1. Нажмите кнопку <PLAY /> одновременно со вторым пользователем.\n        <br />\n        2. После нажатия начнётся обратный отсчёт, вам нужно нажать второй раз на <PLAY /> максимально одновременно\n        <br />\n        3. Обратите внимание, что посмотреть спектакль повторно по одному билету у вас не получится\n        {/* {typeof this.state.left !== \"undefined\" &&\n          this.state.left ?\n            <><br /><br /><b>Пожалуйста, сядьте слева</b></>\n            :\n            <><br /><br /><b>Пожалуйста, сядьте справа</b></>\n          } */}\n      </div>\n\n      <div className=\"spekt__spekt__player\">\n        <div\n          className=\"spekt__spekt__player__button-area\"\n        >\n          <button\n            className=\"spekt__spekt__player__button\"\n            onClick={() => this.pressButton()}\n            disabled={this.state.buttonDisabled}\n          />\n        </div>\n        <div className=\"spekt__spekt__player__text\">\n          {this.state.message}\n        </div>\n        <div className=\"spekt__spekt__player__comment\">\n          {this.state.buttonStatus === \"can-restart\" &&\n            <button\n              className=\"spekt__spekt__player__comment__restart\"\n              onClick={() => this.restart()}\n            >\n              перезапустить\n            </button>}\n          {this.state.buttonStatus === \"buy-another-ticket\" &&\n            <button\n              className=\"spekt__spekt__player__comment__restart\"\n              onClick={() => this.buyAnotherTicket()}\n            >\n              купить ещё один билет\n            </button>}\n          <div className=\"spekt__spekt__player__comment__text\">\n            {this.state.comment}\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n  render = () =>\n    <>\n      {this.state.authorised && !this.state.authorised.match(/none|outdated|many-devices|fake/gm) &&\n        <Header />}\n      <button onClick={() => this.logout()} >\n        выйти\n      </button>\n\n      <div className=\"container\">\n        <div className=\"spekt\">\n          {/* <Loader disappear={this.state.authorised !== \"pending\"} /> */}\n          {this.state.authorised === \"real\" ?\n            this.state.secondUser === \"pending\" ?\n              <div className=\"spekt__login__pending\">\n                Нарисуйте что-нибудь,<br />пока мы ждем второго<br />пользователя\n              </div>\n              :\n              this.state.canSelect ?\n                this.renderSelect()\n                :\n                this.renderSpekt()\n            :\n            this.renderLogin()\n          }\n        </div>\n      </div>\n    </>\n}\n\nSpekt.contextType = StoreContext\n\nexport default withRouter(Spekt)","import React, { Component } from 'react'\nimport { withRouter } from 'react-router'\n\n\nexport default WrappedComponent => {\n  class InnerComponentWithRef extends Component { \n    render() {\n      const { forwardRef, ...rest } = this.props\n      \n      return (\n        <WrappedComponent\n          {...rest}\n          ref={forwardRef}\n        />\n      )\n    }\n  }\n\n  const ComponentWithRouter = withRouter(InnerComponentWithRef, { withRef: true })\n\n  return React.forwardRef((props, ref) =>\n    <ComponentWithRouter\n      {...props}\n      forwardRef={ref}\n    />\n  )\n}","import React from 'react'\nimport { format } from 'date-fns'\nimport CSVReader from 'react-csv-reader'\nimport fetch from 'isomorphic-unfetch'\n\nimport Input from 'components/Input'\nimport { StoreContext } from 'utils/store'\nimport encodeParams from 'utils/encodeParams'\n\n\nclass Admin extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      data: [],\n      password: \"\",\n      loggedIn: true,\n      file: undefined,\n    }\n  }\n\n  loadData = async () => {\n    this.setState({\n      data: await (await fetch(\"https://schedule.tochkadostupa.spb.ru/api/nottoscaleticket?limit=5000\")).json()\n    })\n    // console.log(await (await fetch(\"https://schedule.tochkadostupa.spb.ru/api/nottoscaleticket?limit=5000\")).json())\n  }\n\n  deleteData = async () => {\n    await this.loadData()\n\n    const { data } = this.state\n\n    for (let index in data)\n      console.log(`destroyed ${\n        JSON.stringify(\n          await (\n            await fetch(\n              \"https://schedule.tochkadostupa.spb.ru/api/nottoscaleticket/destroy/\" + data[index].id\n            )\n          ).json())}`)      \n  }\n\n  addData = async data => {\n    await this.deleteData()\n\n    for (let index in data)\n      console.log(await (await fetch(\n        \"https://schedule.tochkadostupa.spb.ru/api/nottoscaleticket/create?\" +\n        encodeParams({\n          number: data[index][0],\n        }))).json())\n      \n    await this.loadData()\n  }\n\n  componentDidMount = () =>\n    this.loadData()\n\n  render() {\n    const { password, loggedIn, data } = this.state\n\n    return !loggedIn ?\n      <div className=\"ZoomTicket\">\n        <div className=\"container\">\n          <Input\n            value={password}\n            onChange={value => this.setState({\n              password: value,\n              loggedIn: value === \"aNg2R4V5\",\n            })}\n            placeholder=\"пароль\"\n          />\n        </div>\n      </div>\n    :\n      <div className=\"ZoomTicket\">\n        <div className=\"container\">\n          загрузка .CSV файла (все данные будут перезаписаны)\n          <CSVReader\n            onFileLoaded={(data, fileInfo) => this.addData(data)}\n          />\n        </div>\n        <div className=\"container\">\n          <div className=\"ZoomTicket__tickets\">\n            <h4 className=\"h4\">Текущие билеты:</h4>\n            {data.map((ticket, index) =>\n              <div\n                key={ticket.id}\n                className=\"ZoomTicket__tickets__item\"\n              >\n                <div className=\"ZoomTicket__tickets__item__index\">\n                  {index + 1}.\n                </div>\n                <div className=\"ZoomTicket__tickets__item__ticketNumber\">\n                  {ticket.number}\n                </div>\n                <div className=\"ZoomTicket__tickets__item__zoomURL\">\n                  {ticket.used ? format(new Date(ticket.used * 1000), 'dd/mm/yyyy') : \"не активирован\"}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n  }\n}\n\nAdmin.contextType = StoreContext\n\nexport default Admin","export default params => \n  Object.entries(params)\n    .map(key => key.map(encodeURIComponent).join(\"=\"))\n      .join(\"&\")\n","import React from 'react'\n\n\nexport default props =>\n  <a\n    className={props.className}\n    href={props.to}\n    target={props.newTab ? \"_blank\" : \"\"}\n    rel=\"noopener noreferrer\"\n  >\n    {props.children}\n  </a>","import React, { Component } from 'react'\n\nimport ExternalLink from 'components/ExternalLink'\nimport logoImg from 'img/logo.svg'\nimport logoSmallImg from 'img/logo-small.svg'\n\n\nexport default class Header extends Component {\n  state = {}\n\n  render = () =>\n    <div className=\"footer\" ref={this.props.elemRef} >\n      <div className=\"container\">\n        <div className=\"footer__logo\">\n          <ExternalLink newTab to=\"https://tochkadostupa.spb.ru\">\n            <img className=\"desktop-only\" src={logoImg} />\n            <img className=\"mobile-only\" src={logoSmallImg} />\n          </ExternalLink>\n        </div>\n        <div className=\"footer__links\">\n          <ExternalLink newTab to=\"https://tochkadostupa.spb.ru/events/not_to_scale\">\n            о проекте\n          </ExternalLink>\n        </div>\n      </div>\n    </div>\n}\n","import React, { Component } from 'react'\nimport ResizeObserver from 'resize-observer-polyfill'\n\nimport isTouchDevice from 'utils/isTouchDevice'\n\n\nexport default class Header extends Component {\n  constructor(props) {\n    super(props)\n\n    this.pos = {\n      x: undefined,\n      y: undefined,\n    }\n    this.pressed = false\n\n    this.canvasRef = React.createRef()\n\n    if (isTouchDevice()) {\n      document.addEventListener('touchmove', e => this.drawTouch(e))\n      document.addEventListener('touchstart', e => { this.pressed = true; this.setPosTouch(e) })\n      document.addEventListener('touchend', e => { this.pressed = false; this.setPosTouch(e) })\n    } else {\n      document.addEventListener('mousemove', e => this.draw(e))\n      document.addEventListener('mousedown', e => this.setPos(e))\n      document.addEventListener('mouseenter', e => this.setPos(e))\n    }\n  }\n\n  componentDidMount = () => {\n    this.resizeObserver = new ResizeObserver(() => this.resize())\n      .observe(this.canvasRef.current)\n    \n    this.resize()\n  }\n\n  resize = () => {\n    const ctx = this.getCtx()\n\n    if (ctx) {\n      ctx.canvas.width = this.canvasRef.current.clientWidth\n      ctx.canvas.height = this.canvasRef.current.clientHeight\n    }\n  }\n\n  getCtx = () => \n    this.canvasRef.current &&\n      this.canvasRef.current.getContext('2d')\n\n  setPos = e =>\n    this.pos = {\n      x: e.clientX,\n      y: e.clientY\n    }\n\n  setPosTouch = e => {\n    const touch = e.changedTouches && e.changedTouches[0]\n\n    if (touch)\n      this.pos = {\n        x: touch.pageX,\n        y: touch.pageY\n      }\n  }\n\n  draw = e => {\n    const ctx = this.getCtx()\n\n    if (!ctx || typeof this.pos.x === \"undefined\" || e.buttons !== 1)\n      return\n\n    ctx.beginPath()\n    ctx.lineWidth = 2.5\n    ctx.lineCap = 'round'\n    ctx.strokeStyle = '#ee0200'\n\n    ctx.moveTo(this.pos.x, this.pos.y)\n    this.setPos(e)\n    ctx.lineTo(this.pos.x, this.pos.y)\n\n    ctx.stroke()\n  }\n\n  drawTouch = e => {\n    const ctx = this.getCtx()\n\n    if (!ctx || typeof this.pos.x === \"undefined\" || !this.pressed)\n      return\n\n    ctx.beginPath()\n    ctx.lineWidth = 2.5\n    ctx.lineCap = 'round'\n    ctx.strokeStyle = '#ee0200'\n\n    ctx.moveTo(this.pos.x, this.pos.y)\n    this.setPosTouch(e)\n    ctx.lineTo(this.pos.x, this.pos.y)\n\n    ctx.stroke()\n  }\n    \n\n  render = () =>\n    <div className=\"canvas\" ref={this.props.elemRef}>\n      <canvas ref={this.canvasRef} />\n    </div>\n}\n","export default () => {\n  try {\n    document.createEvent(\"TouchEvent\")\n    return true\n  } catch (e) {\n    return false\n  }\n}","import React from 'react'\n\nimport browserType from 'utils/browserType'\n\n\n class Header extends React.Component {\n  state = {}\n\n  render = () => {\n    const links = [\n      <a href=\"safari://the-sociophobic.github.io/not-to-scale\" target=\"_blank\">Safari</a>,\n      <a href=\"googlechrome://the-sociophobic.github.io/not-to-scale\" target=\"_blank\">Chrome</a>,\n    ]\n    const firstLink = browserType() === \"not iOS\" ? links[1] : links[0]\n    const secondLink = browserType() === \"not iOS\" ? links[0] : links[1]\n\n    return (\n      <div className=\"open-browser\">\n        <div className=\"open-browser__text\">\n          Пожалуйста, откройте сайт<br />в {firstLink} или {secondLink}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Header","import React, { Component } from 'react'\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\"\nimport Div100vh from 'react-div-100vh'\n\nimport { StoreContext, initialState } from 'utils/store'\nimport browserType from 'utils/browserType'\nimport { registerListeners, unregisterListeners } from 'utils/preventMobileScrolling'\n\nimport Spekt from 'pages/Spekt'\nimport Admin from 'pages/Admin'\nimport Footer from 'components/Footer'\nimport Canvas from 'components/Canvas'\nimport OpenBrowser from 'components/OpenBrowser'\n\nimport './styles/index.sass'\n\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = initialState({\n      state: this.state,\n      setState: this.setState,\n    })\n\n    this.appRef = React.createRef()\n    this.footerRef = React.createRef()\n    this.canvasRef = React.createRef()\n  }\n\n  componentDidMount = () => {\n    // registerListeners(this.appRef.current, true)\n    registerListeners(this.footerRef.current)\n    registerListeners(this.canvasRef.current)\n  }\n\n  componentWillUnmount = () => {\n    // unregisterListeners(this.appRef.current, true)\n    unregisterListeners(this.footerRef.current)\n    unregisterListeners(this.canvasRef.current)\n  }\n\n  render = () =>\n    <Router>\n      <StoreContext.Provider value={this.state}>\n        <Div100vh>\n          <Canvas elemRef={this.canvasRef} />\n          <div\n            className=\"App\"\n            ref={this.appRef}\n          >\n            {browserType() === \"uiwebview\" ?\n              <OpenBrowser />\n              :\n              <div className=\"content\">\n                <Switch>\n                  <Route exact path=\"/not-to-scale/\">\n                    <Spekt />\n                  </Route>\n                  <Route path=\"/not-to-scale/admin\">\n                    <Admin />\n                  </Route>\n                </Switch>\n              </div>\n            }\n            <Footer elemRef={this.footerRef} />\n          </div>\n        </Div100vh>\n      </StoreContext.Provider>\n    </Router>\n}\n\nexport default App\n","import storeClass from './storeClass'\nimport StoreContext from './StoreContext'\n\n\nconst initialState = stateRefs => ({\n  store: new storeClass({\n    stateRefs: stateRefs,\n    DBlink: \"https://schedule.tochkadostupa.spb.ru/not-to-scale/api\",\n    // DBlink: \"http://localhost:3000/not-to-scale/api\",\n  }),\n})\n\nexport {\n  storeClass,\n  StoreContext,\n  initialState,\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}